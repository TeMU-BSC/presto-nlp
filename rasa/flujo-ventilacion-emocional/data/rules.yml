version: "2.0"

rules:

### greetings rules

- rule: Say hello anytime the user says hello
  steps:
  - intent: greet
  # - action: utter_greet_presentation
  - action: utter_greet_ask_emotion



#- rule: Say goodbye anytime the user says goodbye
  #steps:
  #- intent: goodbye_nicemood
  #- action: utter_goodbye_nicemood

### fallback and chitchat rules

# - rule: Ask the user to rephrase whenever they send a message with low NLU confidence
#   steps:
#   - intent: nlu_fallback
#   - slot_was_set:
#       - sentiment: NEU
#   - action: utter_please_rephrase

- rule: respond to chitchat
  steps:
  - intent: chitchat
  - action: utter_chitchat


### alert rules

- rule: prioritize alert intent
  steps:
  - intent: alert
  - action: utter_alert

- rule: confirm emergency
  steps:
  - intent: emergency
  - action: utter_confirm_emergency

- rule: alert detected
  steps:
  - intent: alert_detected
  - action: utter_alert_detected
 # - action: utter_alert_detected_selector
 
- rule: no alert detected
  steps:
  - intent: no_alert_detected
  - action: utter_alert_detected
  
- rule: confirm retrieval
  steps:
  - intent: confirm_retrieval
  - action: utter_si_contar
  
- rule: confirmtalkpos
  steps:
  - intent: confirmtalkpos
  - action: utter_si_contar
  
- rule: confirmtalkneg
  steps:
  - intent: confirmtalkneg
  - action: utter_si_contar
  
- rule: retrieval alert
  steps:  
  - intent: retrieval_alert_intent
  - action: utter_si_contar

- rule: deny retrieval
  steps:
  - intent: deny_retrieval
  - action: utter_goodbye_nicemood
 
- rule: no emergency
  steps:
  - intent: noemergency
  - action: utter_noemergency
#  - action: action_restart
#  - action: action_listen
  
- rule: retrieval_alert_intent
  steps:
  - intent: retrieval_alert_intent
  - action: utter_si_contar  

- rule: prioritize gender violence intent
  steps:  
  - intent: genderViolence
  - action: utter_start_genderViolence

- rule: keep in gv flow
  steps: 
  - intent: confirmgv
  - action: utter_ask_genderViolence

- rule: keep in gv flow 2
  steps:
  - intent: confirmgv2
  - action: utter_ask_2_genderViolence
  
- rule: keep in gv flow 2
  steps:
  - intent: no_confirmgv2
  - action: utter_ask_2_genderViolence
  
- rule: keep in gv flow 3
  steps:
  - intent: confirmgv3
  - action: utter_call_to_emergency_gv
#  - action: utter_retrieval

- rule: denygv 
  steps:
  - intent: denygv
  - action: utter_answer_no_genderViolence
  - action: utter_call_to_emergency_gv_denylastcuestion
#  - action: utter_retrieval  

#- rule: restart
  #steps: 
  #- intent: noemergency
  #- action: utter_noemergency
#  - action: action_restart
#  - action: action_listen
# - intent: utter_start_genderViolence:
# - action: deny
# - action: restart   PROBAR ESTO

# - rule: bring_back ##experimentacion
#   steps:
#   - intent: bring_back
#   # - action: utter_restart
#   - action: utter_si_contar

- rule: respond to FAQs
  steps:
  - intent: faq
  - action: utter_faq

### unlikely hoping wrap up worksa

# - rule: every time we receive unlikely intent in wrap-up take those actions below
#   steps:
#     - action: action_unlikely_intent
#     - action: utter_out_of_scope-wrap_up


## gratitude
- rule: everytime the user says thanks.
  steps:
  - intent: thanks
  - action: utter_thanks
  
- rule: please rephrase
  steps:
  - intent: incomprensible
  - action: utter_please_rephrase
  
## despedida
- rule: confirma goodbye
  steps:
  - intent: goodbye_nicemood
  - action: utter_confirm_goodby
  
- rule: despedida sí
  steps:  
  - intent: confirm_goodby
  - action: utter_goodbye_nicemood

- rule: despedida no
  steps:
  - intent: deny_goodby
  - action: utter_retrieval

# para quan apreta un botó
- rule: acaba con inicio_app
  steps:
  - intent: inicio_app
  - action: action_listen
  
- rule: acaba con recursos_emergencia
  steps:
  - intent: recursos_emergencia
  - action: action_listen
  
- rule: acaba con escala_suicidio
  steps:
  - intent: escala_suicidio
  - action: action_listen
  
- rule: acaba con modulo_distorsiones
  steps:
  - intent: modulo_distorsiones
  - action: action_listen
  
#escolta en les fletxes descendents
#- rule: escucha utter_flecha_descendiente_1
  #steps:
  #- intent: utter_flecha_descendiente_1
  #- action: action_listen
  
#- rule: escucha utter_flecha_descendiente_2
  #steps:
  #- intent: utter_flecha_descendiente_2
  #- action: action_listen


# - rule: Activate sentiment_form
#   steps:
#   - intent: inform_sentiment
#   - action: sentiment_form
# se desactiva esta regla hasta que este montado el endpoint para el formulario de emociones,
# ya que entra en conflicto con las stories
