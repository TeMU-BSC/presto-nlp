version: "2.0"

stories:

# Transervsal stories

  - story: thanks
    steps:
      - intent: thanks
      - action: utter_thanks

  - story: goodbye
    steps:
      - intent: goodbye_nicemood
      - action: utter_goodbye_nicemood
      - intent: thanks

# POS stories

  - story: Emotion POS 
    steps:
      - intent: greet                       # hola
      - action: utter_greet_ask_emotion     # cómo estás hoy?
      - or: 
        - intent: inform_sentiment
        - intent: nlu_fallback
        - intent: sobregeneralizacion
        - intent: etiquetado 
      - slot_was_set:
          - sentiment: POS                  # positivo
      - action: utter_sentiment_POS         # fantastico!
      - action: utter_ask_tell_more_POS     # quieres contarme algo mas? (selector)
      - intent: confirm                     # sí o directamente 
      - action: utter_si_contar             # soy todo oidos
      - or: 
        - intent: inform_sentiment
        - intent: nlu_fallback
        - intent: sobregeneralizacion
        - intent: etiquetado
      - slot_was_set:
          - sentiment: POS                  # positivo
      - action: utter_sentiment_POS         # fantastico! %% es repeteix amb l'anterior. creem un 2?
      - action: utter_selector_POS_last     # quieres contarme algo mas o aprender emociones positivas?

  - story: Emotion POS deny 
    steps:
     - intent: greet                        # hola
     - action: utter_greet_ask_emotion      # cómo estás hoy?
     - or: 
       - intent: inform_sentiment
       - intent: nlu_fallback
       - intent: sobregeneralizacion
       - intent: etiquetado # rasa 3 con la condicion slot = pos y ya sino lista de intents + pos
     - slot_was_set:
        - sentiment: POS                    # positivo
     - action: utter_sentiment_POS          # fantastico!
     - action: utter_ask_tell_more_POS      # quieres contarme algo mas? (selector)
     - intent: deny                         # no
     - action: utter_selector_POS_last      # quieres contarme algo mas o aprender emociones positivas?


  - story: EmotionClassification - selector Confirm
    steps:
      - action: utter_selector_POS_last     # quieres contarme algo mas o aprender emociones positivas?
      - intent: feedbackemotionpos          # aprender
      - action: utter_advice_POS            # explicación
      - action: utter_selector_POS_finish   # te ha sido útil?
      - intent: confirmfb                   # sí
      - action: utter_advice_POS_finish     # despedida contenta
      
  - story: EmotionClassification - selector Denyutility
    steps:
      - action: utter_selector_POS_last     # quieres contarme algo más o aprender emociones positivas?
      - intent: feedbackemotionpos          # aprender
      - action: utter_advice_POS            # explicación
      - action: utter_selector_POS_finish   # te ha sido útil?
      - intent: denyfb                      # no
      - action: utter_negative_feedback_POS # despedida y visita nuestro web

  - story: EmotionClassification - selector Denyhelp
    steps:
      - action: utter_selector_POS_last     # quieres contarme algo mas o aprender emociones positivas?
      - intent: confirmtalkpos              # contar más
      - action: utter_si_contar             # soy todo oídos
      
      
  - story: EmotionClassification - selector Denyhelp Largo
    steps:
      - action: utter_selector_POS_last     # quieres contarme algo mas o aprender emociones positivas?
      - intent: confirmtalkpos              # contar más
      - action: utter_si_contar             # soy todo oídos
      - or: 
        - intent: inform_sentiment
        - intent: nlu_fallback
        - intent: sobregeneralizacion
        - intent: etiquetado
      - slot_was_set:
          - sentiment: POS                  # positivo
      - action: utter_sentiment_POS         # fantastico! %% es repeteix amb l'anterior. creem un 2?
      - action: utter_ventilacion_nd_1     # Quieres contarme un poquito más sobre este tema?

  - story: EmotionClassification - neutral emotion 
    steps:
      # - intent: greet
      # - action: utter_greet_ask_emotion
      - intent: inform_sentiment
      # - action: sentiment_form
      - slot_was_set:
          - sentiment: NEU
      - action: utter_sentiment_NEU

# sigue contando

  - story: keepontalking
    steps:
      - or: 
        - intent: inform_sentiment
        - intent: nlu_fallback
      - or: 
        - intent: inform_sentiment
        - intent: nlu_fallback     
      - action: utter_si_contar             # soy todo oidos

# NEG stories

  - story: EmotionClassification - negative emotion - contar 1
    steps:
      - intent: greet                       # hola
      - action: utter_greet_ask_emotion     # qué tal estás?
      - or: 
        - intent: nlu_fallback
        - intent: inform_sentiment       
      - slot_was_set:
          - sentiment: NEG                  # mal
      - action: utter_sentiment_NEG         # lo siento, cuéntame más
      - or: 
        - intent: nlu_fallback
        - intent: inform_sentiment
      - slot_was_set:
        - sentiment: NEG                    # estoy mal
    # - action: utter_ventilacion_nd_1
      - action: utter_selector_contar       # lo siento. quieres contarme más?
      - intent: confirmcontar               # sí 
      - action: utter_si_contar             # soy todo oídos
      - or:
        - intent: nlu_fallback
        - intent: inform_sentiment
      - slot_was_set:
        - sentiment: NEG                    # estoy mal
      - action: utter_selector_NEG_last     # contar más o feedback emoción negativa?
      # - checkpoint: user_give_emotion_NEG

  - story: EmotionClassification - negative emotion - no contar 1
    steps:
      - intent: greet                       # hola
      - action: utter_greet_ask_emotion     # qué tal estás?
      - or: 
        - intent: nlu_fallback
        - intent: inform_sentiment         
      - slot_was_set:
          - sentiment: NEG                  # mal
      - action: utter_sentiment_NEG         # lo siento, cuéntame más
      - or: 
        - intent: nlu_fallback
        - intent: inform_sentiment
      - slot_was_set:
        - sentiment: NEG                    # estoy mal
      - action: utter_selector_contar       # lo siento. quieres contarme más?
      - intent: denyContar                  # no
      - action: utter_no_contar             # no pasa nada
      - action: utter_selector_NEG_last    # contar más o feedback emoción negativa?

  - story: aprender emociones neg - útil
    steps:
      - action: utter_selector_NEG_last     # contar más o feedback emoción negativa?
      - intent: feedbackemotionneg          # aprender emociones negativas
      - action: utter_advice_NEG            # explicación
      - action: utter_selector_POS_finish   # te ha sido útil?
      - intent: confirmfb                   # sí
      - action: utter_advice_POS_finish     # despedida contenta

  - story: aprender emociones neg - no útil
    steps:
      - action: utter_selector_NEG_last     # contar más o feedback emoción negativa?
      - intent: feedbackemotionneg          # aprender emociones negativas
      - action: utter_advice_NEG            # explicación
      - action: utter_selector_POS_finish   # te ha sido útil?
      - intent: denyfb                      # no
      - action: utter_negative_feedback_POS # despedida y visita nuestro web
      
  - story: seguir contando
    steps:
      - action: utter_selector_NEG_last     # contar más o feedback emoción negativa?
      - intent: confirmtalkneg              # contar más
      - action: utter_si_contar      # i utter_si_contar?
      - or: 
        - intent: nlu_fallback
        - intent: inform_sentiment
      - slot_was_set:
        - sentiment: NEG                    # estoy mal
      - action: utter_ventilacion_nd_1      # vaya, te animo a que sigas


#---------------------------

### Distortions inquiries

  - story: chatting distorsions 
    steps:
      - intent: greet                       # hola
      - action: utter_greet_ask_emotion     # qué tal estás?
      - or:
        - intent: sobregeneralizacion       # distorsion o mal
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
        - intent: inform_sentiment   
        - intent: nlu_fallback 
      - slot_was_set:
        - sentiment: NEG                  
      - action: utter_sentiment_NEG         # lo lamento, cuéntame más
      - or:
        - intent: sobregeneralizacion       # distorsion 1
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
      # - slot_was_set:
      #     - sentiment: NEG
      - action: utter_ventilacion_1         # sigue contando
      - or:
        - intent: sobregeneralizacion       # distorsion 2
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
      # - slot_was_set:
      #     - sentiment: NEG
      - action: utter_ventilacion_2         # determinadas emociones son complicadas. Explícame más
      - checkpoint: distorsion_ready        # tenemos una distorsión
      
  - story: chatting distorsions 2
    steps:
      - intent: greet                       # hola
      - action: utter_greet_ask_emotion     # qué tal estás?
      - or:
        - intent: sobregeneralizacion       # distorsion 1
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
        - intent: inform_sentiment   
      - action: utter_sentiment_NEG         # lo lamento, cuéntame más
      - or:
        - intent: sobregeneralizacion       # distorsion o mal
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
        - intent: nlu_fallback 
      - slot_was_set:
        - sentiment: NEG            
      - action: utter_ventilacion_1         # sigue contando
      - or:
        - intent: sobregeneralizacion       # distorsion 2
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
      - action: utter_ventilacion_2         # determinadas emociones son complicadas. Explícame más
      - checkpoint: distorsion_ready        # tenemos una distorsión
    
    
  - story: chatting distorsions short
    steps:
      - action: utter_sentiment_NEG         # lo lamento, cuéntame más
      - or:
        - intent: sobregeneralizacion       # distorsion 1
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
      # - slot_was_set:
      #     - sentiment: NEG
      - action: utter_ventilacion_1         # sigue contando
      - or:
        - intent: sobregeneralizacion       # distorsion 2
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
      # - slot_was_set:
      #     - sentiment: NEG
      - action: utter_ventilacion_2         # determinadas emociones son complicadas. Explícame más
      - checkpoint: distorsion_ready        # tenemos una distorsión


### PSICOEDUCAT

  - story: psicoeduc_sobre
    steps:
      - checkpoint: distorsion_ready        # distorsion detectada
      - intent: sobregeneralizacion         # sobregeneralizacion
      - action: utter_psicoeduc_general     # explicación distorsion
      - action: utter_selector_psicoeduc_general    # quieres trabajarlo?
      - intent: confirmPsicoGen             # sí -- falta neg
      - action: utter_psicoeduc_sobre       # explicación sobre
      - action: utter_selector_psicoeduc_1  # quieres continuar
      - intent: confirmPsico1               # sí -- falta neg
      - action: utter_psicoeduc_sobre_2     # ejemplo concreto
      - action: utter_selector_psicoeduc_sobre_2    # te sientes identificado?
      - or:
        - intent: confirmSobre
        - intent: denySobre
      - action: utter_intervencion_sobregen # orientación al web


  - story: intervencion_etiquetado
    steps:
      - checkpoint: distorsion_ready        # distorsion detectada
      - intent: etiquetado                  # etiquetado
      - action: utter_psicoeduc_general     # explicación distorsion
      - action: utter_selector_psicoeduc_general    # quieres trabajarlo?
      - intent: confirmPsicoGen             # sí -- falta neg
      - action: utter_psicoeduc_etiquetado  # explicación etiquetado
      - action: utter_selector_psicoeduc_1  # quieres continuar
      - intent: confirmPsico1               # sí -- falta neg
      - action: utter_psicoeduc_etiquetado_2            # ejemplo concreto
      - action: utter_selector_psicoeduc_etiquetado_2   # te sientes identificado?
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_etiquetado   # orientación al web

  - story: intervencion_lectordementes
    steps:
      - checkpoint: distorsion_ready
      - intent: lectordementes
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirmPsicoGen
      - action: utter_psicoeduc_lectordementes
      - action: utter_selector_psicoeduc_1
      - intent: confirmPsico1
      - action: utter_psicoeduc_lectordementes_2
      - action: utter_selector_psicoeduc_lectordementes_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_lectordementes

  - story: intervencion_adivinacion
    steps:
      - checkpoint: distorsion_ready
      - intent: adivinacion
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirmPsicoGen
      - action: utter_psicoeduc_adivinacion
      - action: utter_selector_psicoeduc_1
      - intent: confirmPsico1
      - action: utter_psicoeduc_adivinacion_2
      - action: utter_selector_psicoeduc_adivinacion_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_adivinacion

  - story: intervencion_deberias
    steps:
      - checkpoint: distorsion_ready
      - intent: deberias
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirmPsicoGen
      - action: utter_psicoeduc_deberias
      - action: utter_selector_psicoeduc_1
      - intent: confirmPsico1
      - action: utter_psicoeduc_deberias_2
      - action: utter_selector_psicoeduc_deberias_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_deberias

  - story: intervencion_catastrofismo
    steps:
      - checkpoint: distorsion_ready
      - intent: catastrofismo
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirmPsicoGen
      - action: utter_psicoeduc_catastrofismo
      - action: utter_selector_psicoeduc_1
      - intent: confirmPsico1
      - action: utter_psicoeduc_catastrofismo_2
      - action: utter_selector_psicoeduc_catastrofismo_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_catastrofismo

  - story: intervencion_pensamientoabsolutista
    steps:
      - checkpoint: distorsion_ready
      - intent: pensamientoabsolutista
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirmPsicoGen
      - action: utter_psicoeduc_pensamientoabsolutista
      - action: utter_selector_psicoeduc_1
      - intent: confirmPsico1
      - action: utter_psicoeduc_pensamientoabsolutista_2
      - action: utter_selector_psicoeduc_pensamientoabsolutista_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_pensamientoabsolutista

### se ha detectado distorsion pero el usuario no quiere continuar
  - story: no intervención
    steps:
      - action: utter_psicoeduc_general                 # explicación distorsion
      - action: utter_selector_psicoeduc_general        # quieres trabajarlo?
      - intent: denyPsicoGen                            # no
      - action: utter_denypsicoeduc                     # de acuerdo, consulta el web


  - story: no continuar
    steps:
      - action: utter_selector_psicoeduc_1              # quieres continuar?
      - intent: denyPsicoedu                            # no
      - action: utter_denypsicoeduc                     # de acuerdo, consulta el web
 
