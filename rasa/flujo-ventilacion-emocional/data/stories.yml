version: "2.0"

stories:


# Transervsal stories


# version: "2.0"

# stories:

  - story: Emotion POS 
    steps:
      - intent: greet
      - action: utter_greet_ask_emotion
      - or: 
        - intent: inform_sentiment
        - intent: nlu_fallback
        - intent: sobregeneralizacion
        - intent: etiquetado # rasa 3 con la condicion slot = pos y ya sino lista de intents + pos
      - slot_was_set:
          - sentiment: POS
      - action: utter_sentiment_POS # fantastico!
      - action: utter_ask_tell_more_POS #quieres contarme algo mas? -- meterle el selector
      ##----------------hasta aquí base
      - intent: confirm # sí o directamente 
      - action: utter_si_contar #soy todo oidos
      - or: 
        - intent: inform_sentiment
        - intent: nlu_fallback
        - intent: sobregeneralizacion
        - intent: etiquetado
      - slot_was_set:
          - sentiment: POS
      - action: utter_sentiment_POS #fantastico!
      - action: utter_selector_POS_last #quieres contarme algo mas o feedback?

  - story: Emotion POS deny ## en progreso
    steps:
     - intent: greet
     - action: utter_greet_ask_emotion
     - or: 
       - intent: inform_sentiment
       - intent: nlu_fallback
       - intent: sobregeneralizacion
       - intent: etiquetado # rasa 3 con la condicion slot = pos y ya sino lista de intents + pos
     - slot_was_set:
        - sentiment: POS
     - action: utter_sentiment_POS # fantastico!
     - action: utter_ask_tell_more_POS #quieres contarme algo mas? 
      ##----------------hasta aquí base
     - intent: deny
     - action: utter_selector_POS_last


  - story: EmotionClassification - selector Confirm
    steps:
      - action: utter_selector_POS_last
      - intent: feedbackemotion
      - action: utter_advice_POS
      - action: utter_selector_POS_finish
      - intent: confirm
      - action: utter_advice_POS_finish
      
  - story: EmotionClassification - selector Denyutility
    steps:
      - action: utter_selector_POS_last
      - intent: feedbackemotion
      - action: utter_advice_POS
      - action: utter_selector_POS_finish
      - intent: deny
      - action: utter_negative_feedback_POS

  - story: EmotionClassification - selector Denyhelp
    steps:
      - action: utter_selector_POS_last
      - intent: deny
      - action: utter_goodbye_nicemood

  - story: thanks
    steps:
      - intent: thanks
      - action: utter_thanks

  - story: goodbye
    steps:
      - intent: goodbye_nicemood
      - action: utter_goodbye_nicemood
      - intent: thanks


# Emotion classification
  - story: EmotionClassification - negative emotion # ok revisado
    steps:
      - intent: greet
      - action: utter_greet_ask_emotion
      - intent: inform_sentiment
      - slot_was_set:
          - sentiment: NEG
      - action: utter_sentiment_NEG

  - story: emotion prueba
    steps:
      - action: utter_sentiment_NEG 
      - or: 
        - intent: nlu_fallback
        - intent: inform_sentiment
      - slot_was_set:
        - sentiment: NEG
    # - action: utter_ventilacion_nd_1
      - action: utter_selector_contar
      - intent: confirmcontar
      - action: utter_si_contar
      - or:
        - intent: nlu_fallback
        - intent: inform_sentiment
      - slot_was_set:
        - sentiment: NEG
      - action: utter_selector_NEG_last
      # - checkpoint: user_give_emotion_NEG

  - story: EmotionClassification - neutral emotion  # ok revisado
    steps:
      # - intent: greet
      # - action: utter_greet_ask_emotion
      - intent: inform_sentiment
      # - action: sentiment_form
      - slot_was_set:
          - sentiment: NEU
      - action: utter_sentiment_NEU


### Inquiries non distortions
  # - story: non distorsion - negative emotion
  #   steps:
  #   # - checkpoint: user_give_emotion_NEG
  #   - or:
  #     - intent: nlu_fallback
  #     - intent: inform_sentiment
  #   - slot_was_set:
  #       - sentiment: NEG
  #   # - action: utter_ventilacion_nd_1
  #   - action: utter_selector_contar
  #   - intent: confirmcontar
  #   - action: utter_si_contar
  #   - or:
  #     - intent: nlu_fallback
  #     - intent: inform_sentiment
  #   - slot_was_set:
  #       - sentiment: NEG
  #   - action: utter_selector_NEG_last

  - story: EmotionClassification - selector Confirm
    steps:
      - action: utter_selector_NEG_last
      - intent: feedbackemotion
      - action: utter_advice_NEG
      - action: utter_selector_POS_finish
      - intent: confirm
      - action: utter_advice_POS_finish

  - story: EmotionClassification - selector Denyhelp
    steps:
      - action: utter_selector_NEG_last
      - intent: deny
      - action: utter_goodbye_nicemood
  
  # - story: EmotionClassification - selector Denyutility
  #   steps:
  #     - action: utter_selector_NEG_last
  #     - intent: feedbackemotion
  #     - action: utter_advice_NEG
  #     - action: utter_selector_POS_finish
  #     - intent: deny
  #     - action: utter_advice_POS_finish
  #--------------------------------------------------------

  - story: non distorsion - negative emotion - no contar
    steps:
    - action: utter_ventilacion_nd_1
    - action: utter_selector_contar
    - intent: deny
    - action: utter_no_contar

#---------------------------

### Distortions inquiries

  - story: chatting distorsions - two steps WITHOUT EMOTION INIT
    steps:
      # - action: sentiment_form
      # - action: utter_si_contar
      - action: utter_sentiment_NEG
      - or:
        - intent: sobregeneralizacion
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
      # - slot_was_set:
      #     - sentiment: NEG
      - action: utter_ventilacion_1
      - or:
        - intent: sobregeneralizacion
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
      # - slot_was_set:
      #     - sentiment: NEG
      - action: utter_ventilacion_2
      - checkpoint: distorsion_ready


### psicoeduc e intervencion primera

  - story: psicoeduc_sobre
    steps:
      - checkpoint: distorsion_ready
      - intent: sobregeneralizacion
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_sobre # definicion
      - action: utter_selector_psicoeduc_1 # quieres continuar
      - intent: confirm
      - action: utter_psicoeduc_sobre_2 # ejemplo concreto
      - action: utter_selector_psicoeduc_sobre_2 # te sientes identificado
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_sobregen


  - story: intervencion_etiquetado
    steps:
      - checkpoint: distorsion_ready
      - intent: etiquetado
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_etiquetado
      - action: utter_selector_psicoeduc_1
      - intent: confirm
      - action: utter_psicoeduc_etiquetado_2
      - action: utter_selector_psicoeduc_etiquetado_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_etiquetado

  - story: intervencion_lectordementes
    steps:
      - checkpoint: distorsion_ready
      - intent: lectordementes
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_lectordementes
      - action: utter_selector_psicoeduc_1
      - intent: confirm
      - action: utter_psicoeduc_lectordementes_2
      - action: utter_selector_psicoeduc_lectordementes_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_lectordementes

  - story: intervencion_adivinacion
    steps:
      - checkpoint: distorsion_ready
      - intent: adivinacion
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_adivinacion
      - action: utter_selector_psicoeduc_1
      - intent: confirm
      - action: utter_psicoeduc_adivinacion_2
      - action: utter_selector_psicoeduc_adivinacion_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_adivinacion

  - story: intervencion_deberias
    steps:
      - checkpoint: distorsion_ready
      - intent: deberias
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_deberias
      - action: utter_selector_psicoeduc_1
      - intent: confirm
      - action: utter_psicoeduc_deberias_2
      - action: utter_selector_psicoeduc_deberias_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_deberias

  - story: intervencion_catastrofismo
    steps:
      - checkpoint: distorsion_ready
      - intent: catastrofismo
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_catastrofismo
      - action: utter_selector_psicoeduc_1
      - intent: confirm
      - action: utter_psicoeduc_catastrofismo_2
      - action: utter_selector_psicoeduc_catastrofismo_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_catastrofismo

  - story: intervencion_pensamientoabsolutista
    steps:
      - checkpoint: distorsion_ready
      - intent: pensamientoabsolutista
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_pensamientoabsolutista
      - action: utter_selector_psicoeduc_1
      - intent: confirm
      - action: utter_psicoeduc_pensamientoabsolutista_2
      - action: utter_selector_psicoeduc_pensamientoabsolutista_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_pensamientoabsolutista


  # - story: emergency # ok revisado
  #   steps:
  #   - intent: alert
  #   - action: utter_alert # selector con deny y emergency
  #   - intent: emergency
  #   - action: utter_confirm_emergency
  #   - intent: emergency
  #   - action: utter_emergency
  
  - story: emergency with alert /alert_detected
    steps: 
    - intent: alert
    - action: utter_alert
    - intent: emergency
    - action: utter_confirm_emergency
    - intent: alert_detected
    - action: utter_alert_detected
    - action: utter_alert_detected_selector



  # - story: emergency # ok revisado
  #   steps:
  #   - intent: alert
  #   - action: utter_alert # selector con deny y emergency
  #   - intent: confirm
  #   - action: utter_confirm_emergency
  #   - intent: emergency
  #   - action: utter_emergency
  #   - intent: emergency
  #   - action: utter_call_to_emergency

  - story: emergency_false_alarm # ok revisado
    steps:
    - intent: alert
    - action: utter_alert
    - intent: inform_sentiment
    - action: utter_sentiment_NEG #cambiar nombre y poner noemergency. Se queda hasta que decidan flujo final para ambos



  - story: gender_violence_ denyfirstquestion #ok revisado
    steps:
    - intent: genderViolence
    - action: utter_start_genderViolence #selector con deny y emergency
    - intent: inform_sentiment
    - action: utter_sentiment_NEG


  - story: gender_violence_ direct #ok revisado
    steps:
    - intent: genderViolence
    - action: utter_start_genderViolence #selector con deny y emergency
    - intent: confirmgv
    - action: utter_ask_genderViolence
    - intent: confirmgv2 #revisar
    - action: utter_ask_2_genderViolence #revisar   ## Añadir mas
    - intent: confirmgv3
    - action: utter_call_to_emergency_gv


  - story: gender_violence_ direct ultima no #ok revisado
    steps:
    - intent: genderViolence
    - action: utter_start_genderViolence #selector con deny y emergency
    - intent: confirmgv
    - action: utter_ask_genderViolence
    - intent: confirmgv2 #revisar
    - action: utter_ask_2_genderViolence #revisar   ## Añadir mas
    - intent: confirmgv3
    - action: utter_call_to_emergency_gv



  - story: gender_violence_ direct ultima no #ok revisado
    steps:
    - intent: genderViolence
    - action: utter_start_genderViolence #selector con deny y emergency
    - intent: confirmgv
    - action: utter_ask_genderViolence
    - intent: confirmgv2 #revisar
    - action: utter_ask_2_genderViolence #revisar   ## Añadir mas
    - intent: deny
    - action: utter_answer_no_genderViolence
    - action: utter_call_to_emergency_gv_denylastcuestion
