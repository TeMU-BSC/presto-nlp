version: "2.0"

stories:

# Emotion classification:

  - story: EmotionClassification - positive emotion
    steps:
      - intent: greet
      - action: utter_greet_ask_emotion
      - intent: inform_sentiment
      - action: sentiment_form
      - slot_was_set:
          - sentiment: POS
      - action: utter_sentiment_POS
      - action: utter_selector_POS
      - intent: confirm
      - action: utter_advice_POS
      - action: utter_advice_POS_finish

  - story: Emotion POS non advice
    steps:
      - intent: greet
      - action: utter_greet_ask_emotion
      - intent: inform_sentiment
      - action: sentiment_form
      - slot_was_set:
          - sentiment: POS
      - action: utter_sentiment_POS
      - action: utter_selector_POS
      - intent: deny
      - action: utter_goodbye_nicemood


  - story: emotionclassification - test
    steps:
      - slot_was_set:
          - sentiment: POS
      - or:
        - intent: nlu_fallback
        - intent: etiquetado
        - intent: sobregeneralizacion
      - action: utter_sentiment_POS
      - action: utter_selector_POS


  - story: EmotionClassification - negative emotion
    steps:
      - intent: greet
      - action: utter_greet_ask_emotion
      - intent: inform_sentiment
      - action: sentiment_form
      - slot_was_set:
          - sentiment: NEG
      - action: utter_sentiment_NEG
      - checkpoint: user_give_emotion_NEG

  - story: EmotionClassification - neutral emotion
    steps:
      - intent: greet
      - action: utter_greet_ask_emotion
      - intent: inform_sentiment
      - action: sentiment_form
      - slot_was_set:
          - sentiment: NEU
      - action: utter_sentiment_NEU

### Inquiries non distortions

  - story: non distorsion - negative emotion
    steps:
      - checkpoint: user_give_emotion_NEG
      - intent: nlu_fallback
      - slot_was_set:
          - sentiment: NEG
      - action: utter_ventilacion_nd_1
      - intent: nlu_fallback
      - slot_was_set:
          - sentiment: NEG
      - action: utter_chitchat/how_are_u
      - intent: nlu_fallback
      - slot_was_set:
          - sentiment: NEG
      - action: utter_chitchat/ask_name


  - story: non distorsion - positive emotion
    steps:
      - checkpoint: user_give_emotion_NEG
      - intent: nlu_fallback
      - slot_was_set:
          - sentiment: POS
      - action: utter_ventilacion_nd_1



### Distortions inquiries



  - story: chatting distorsions - two steps WITHOUT EMOTION INIT
    steps:
      # - action: sentiment_form
      - slot_was_set:
          - sentiment: NEG
      - or:
        - intent: sobregeneralizacion
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
      - action: utter_ventilacion_1
      # - action: sentiment_form
      - slot_was_set:
          - sentiment: NEG
      - or:
        - intent: sobregeneralizacion
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
      - action: utter_ventilacion_2
      # - checkpoint: distorsion_ready


  # - story: chatting distorsions - two steps
  #   steps:
  #     - checkpoint: user_give_emotion_NEU
  #     # - action: sentiment_form
  #     - slot_was_set:
  #         - sentiment: NEG
  #     - or:
  #       - intent: sobregeneralizacion
  #       - intent: lectordementes
  #       - intent: pensamientoabsolutista
  #       - intent: etiquetado
  #       - intent: catastrofismo
  #       - intent: adivinacion
  #       - intent: deberias
  #     - action: utter_ventilacion_1
  #     # - action: sentiment_form
  #     - slot_was_set:
  #         - sentiment: NEG
  #     - or:
  #       - intent: sobregeneralizacion
  #       - intent: lectordementes
  #       - intent: pensamientoabsolutista
  #       - intent: etiquetado
  #       - intent: catastrofismo
  #       - intent: adivinacion
  #       - intent: deberias
  #     - action: utter_ventilacion_2
  #     - checkpoint: distorsion_ready

  - story: chatting distorsions - two steps
    steps:
      - checkpoint: user_give_emotion_NEG
      # - action: sentiment_form
      - slot_was_set:
          - sentiment: NEG
      - or:
        - intent: sobregeneralizacion
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
      - action: utter_ventilacion_1
      # - action: sentiment_form
      - slot_was_set:
          - sentiment: NEG
      - or:
        - intent: sobregeneralizacion
        - intent: lectordementes
        - intent: pensamientoabsolutista
        - intent: etiquetado
        - intent: catastrofismo
        - intent: adivinacion
        - intent: deberias
      - action: utter_ventilacion_2
      - checkpoint: distorsion_ready


### psicoeduc

  - story: psicoeduc_sobre
    steps:
      - checkpoint: distorsion_ready
      - intent: sobregeneralizacion
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_sobre # definicion
      - action: utter_selector_psicoeduc_1 # quieres continuar
      - intent: confirm
      - action: utter_psicoeduc_sobre_2 # ejemplo concreto
      - action: utter_selector_psicoeduc_sobre_2 # te sientes identificado
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_sobregen

  - story: psicoeduc_sobre
    steps:
      - checkpoint: distorsion_ready
      - intent: sobregeneralizacion
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_sobre # definicion
      - action: utter_selector_psicoeduc_1 # quieres continuar
      - intent: confirm
      - action: utter_psicoeduc_sobre_2 # ejemplo concreto
      - action: utter_selector_psicoeduc_sobre_2 # te sientes identificado
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_sobregen


  - story: intervencion_etiquetado
    steps:
      - checkpoint: distorsion_ready
      - intent: etiquetado
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_etiquetado
      - action: utter_selector_psicoeduc_1
      - intent: confirm
      - action: utter_psicoeduc_etiquetado_2
      - action: utter_selector_psicoeduc_etiquetado_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_etiquetado

  - story: intervencion_lectordementes
    steps:
      - checkpoint: distorsion_ready
      - intent: lectordementes
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_lectordementes
      - action: utter_selector_psicoeduc_1
      - intent: confirm
      - action: utter_psicoeduc_lectordementes_2
      - action: utter_selector_psicoeduc_lectordementes_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_lectordementes

  - story: intervencion_adivinacion
    steps:
      - checkpoint: distorsion_ready
      - intent: adivinacion
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_adivinacion
      - action: utter_selector_psicoeduc_1
      - intent: confirm
      - action: utter_psicoeduc_adivinacion_2
      - action: utter_selector_psicoeduc_adivinacion_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_adivinacion

  - story: intervencion_deberias
    steps:
      - checkpoint: distorsion_ready
      - intent: deberias
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_deberias
      - action: utter_selector_psicoeduc_1
      - intent: confirm
      - action: utter_psicoeduc_deberias_2
      - action: utter_selector_psicoeduc_deberias_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_deberias

  - story: intervencion_catastrofismo
    steps:
      - checkpoint: distorsion_ready
      - intent: catastrofismo
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_catastrofismo
      - action: utter_selector_psicoeduc_1
      - intent: confirm
      - action: utter_psicoeduc_catastrofismo_2
      - action: utter_selector_psicoeduc_catastrofismo_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_catastrofismo

  - story: intervencion_pensamientoabsolutista
    steps:
      - checkpoint: distorsion_ready
      - intent: pensamientoabsolutista
      - action: utter_psicoeduc_general
      - action: utter_selector_psicoeduc_general
      - intent: confirm
      - action: utter_psicoeduc_pensamientoabsolutista
      - action: utter_selector_psicoeduc_1
      - intent: confirm
      - action: utter_psicoeduc_pensamientoabsolutista_2
      - action: utter_selector_psicoeduc_pensamientoabsolutista_2
      - or:
        - intent: confirm
        - intent: deny
      - action: utter_intervencion_pensamientoabsolutista


  - story: emergency
    steps:
    - intent: alert
    - action: utter_alert # selector con deny y emergency
    - intent: emergency
    - action: utter_emergency
    - intent: confirm
    - action: utter_call_to_emergency

  - story: emergency_false_alarm
    steps:
    - intent: alert
    - action: utter_alert
    - intent: inform_sentiment
    - action: utter_answer_no_genderViolence #cambiar nombre y poner noemergency. Se queda hasta que decidan flujo final para ambos

  - story: gender_violence_ direct
    steps:
    - intent: genderViolence
    - action: utter_start_genderViolence
    - intent: emergency
    - action: utter_ask_genderViolence
    - intent: emergency
    - action: utter_ask_2_genderViolence
    - intent: emergency
    - action: utter_call_to_emergency

  # # - story: gender_violence_nondirect
  # #   steps:
  # #   - intent: greet
  # #   - action: utter_greet_ask_emotion
  # #   - intent: genderViolence
  # #   - action: utter_start_genderViolence
  # #   - intent: confirm
  # #   - action: utter_ask_genderViolence
  # #   - intent: confirm
  # #   - action: utter_ask_2_genderViolence
  # #   - intent: confirm
  # #   - action: utter_call_to_emergency

  - story: gender violence_no_risk
    steps:
    - intent: genderViolence
    - action: utter_start_genderViolence
    - intent: deny
    - action: utter_answer_no_genderViolence

  # - story: gender violence_no_risk_nondirect
  #   steps:
  #   - intent: greet
  #   - action: utter_greet_ask_emotion
  #   - intent: genderViolence
  #   - action: utter_start_genderViolence
  #   - intent: deny
  #   - action: utter_answer_no_genderViolence



  ## Interventions


  ### Interventions

  # - story: intervencion_sobre
  #   steps:
  #     - intent: start_intervencion_sobre
  #     - action: utter_selector_intervencion_sobregen
  #     - intent: confirm
  #     - action: utter_intervencion_sobregen



  # - story: intervencion_etiquetado
  #   steps:
  #     - intent: start_intervencion_etiquetado
  #     - action: utter_selector_intervencion_etiquetado
  #     - intent: confirm
  #     - action: utter_intervencion_etiquetado

  # - story: intervencion_lectordementes
  #   steps:
  #     - intent: start_intervencion_lectordementes
  #     - action: utter_selector_intervencion_lectordementes
  #     - intent: confirm
  #     - action: utter_intervencion_lectordementes

  # - story: intervencion_adivinacion
  #   steps:
  #     - intent: start_intervencion_adivinacion
  #     - action: utter_selector_intervencion_adivinacion
  #     - intent: confirm
  #     - action: utter_intervencion_adivinacion

  # - story: intervencion_deberias
  #   steps:
  #     - intent: start_intervencion_deberias
  #     - action: utter_selector_intervencion_deberias
  #     - intent: confirm
  #     - action: utter_intervencion_deberias

  # - story: intervencion_catastrofismo
  #   steps:
  #     - intent: start_intervencion_catastrofismo
  #     - action: utter_selector_intervencion_catastrofismo
  #     - intent: confirm
  #     - action: utter_intervencion_catastrofismo

  # - story: intervencion_pensamientoabsolutista
  #   steps:
  #     - intent: start_intervencion_pensamientoabsolutista
  #     - action: utter_selector_intervencion_pensamientoabsolutista
  #     - intent: confirm
  #     - action: utter_intervencion_pensamientoabsolutista

  # - story: end_intervention
  #   steps:
  #   - checkpoint: end_intervention
  #   - or:
  #       - intent: ready
  #       - intent: thanks
  #       - intent: confirm
  #   - action: utter_youre_welcome

  # - story: alert_non_emergency
  #   steps:
  #   - intent: alert
  #   - action: utter_alert
  #   - intent: inform_sentiment
  #   - action: utter_sentiment_NEG

  # - story: alert_emergency
  #   steps:
  #   - intent: alert
  #   - action: utter_alert
  #   - intent: emergency
  #   - action: utter_emergency


